<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>iMacrosControl.Play Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="Play method" /><meta name="System.Keywords" content="iMacrosControl.Play method" /><meta name="Microsoft.Help.F1" content="iMacros.Component.iMacrosControl.Play" /><meta name="Microsoft.Help.Id" content="M:iMacros.Component.iMacrosControl.Play(System.String)" /><meta name="Description" content="Plays the specified macro code or path." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="iMacros.Component" /><meta name="file" content="1110cf09-8244-6af6-9da8-aa9263993836" /><meta name="guid" content="1110cf09-8244-6af6-9da8-aa9263993836" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">iMacros Component<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html\70f4a70b-7236-3439-3ee4-75d5cd107a12.htm" title="iMacros Component" tocid="roottoc">iMacros Component</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/70f4a70b-7236-3439-3ee4-75d5cd107a12.htm" title="iMacros.Component" tocid="70f4a70b-7236-3439-3ee4-75d5cd107a12">iMacros.Component</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/529dd334-de25-1561-961f-e1d3d9a778cd.htm" title="iMacrosControl Class" tocid="529dd334-de25-1561-961f-e1d3d9a778cd">iMacrosControl Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/daf24880-0651-a056-a3c5-78b15b870a32.htm" title="iMacrosControl Methods" tocid="daf24880-0651-a056-a3c5-78b15b870a32">iMacrosControl Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/3fd36282-4523-77f4-23ac-65697f970b4f.htm" title="Create Method " tocid="3fd36282-4523-77f4-23ac-65697f970b4f">Create Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/6d3fa199-af2d-9f6c-f6bf-4369f3056843.htm" title="Dispose Method " tocid="6d3fa199-af2d-9f6c-f6bf-4369f3056843">Dispose Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/c6ebeae9-70bd-2708-8185-0fabba1fd5e0.htm" title="GetBrowserEmulationMode Method " tocid="c6ebeae9-70bd-2708-8185-0fabba1fd5e0">GetBrowserEmulationMode Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/1d1a48c2-b55a-e17a-b5b7-afe52c7b68bb.htm" title="GetPerformanceData Method " tocid="1d1a48c2-b55a-e17a-b5b7-afe52c7b68bb">GetPerformanceData Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/c19502b3-6d15-61f7-74f5-ed68de9ad37d.htm" title="PauseOrContinue Method " tocid="c19502b3-6d15-61f7-74f5-ed68de9ad37d">PauseOrContinue Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/1110cf09-8244-6af6-9da8-aa9263993836.htm" title="Play Method " tocid="1110cf09-8244-6af6-9da8-aa9263993836">Play Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/5df43c3d-d47f-8055-b830-7ee73998937c.htm" title="SetBrowserEmulationMode Method " tocid="5df43c3d-d47f-8055-b830-7ee73998937c">SetBrowserEmulationMode Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/212e1fcb-2fa9-6ad2-4afd-083d6214dc58.htm" title="SetVariable Method " tocid="212e1fcb-2fa9-6ad2-4afd-083d6214dc58">SetVariable Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/f4d106b6-b2e6-9d08-e181-4ec3bf8d6563.htm" title="Stop Method " tocid="f4d106b6-b2e6-9d08-e181-4ec3bf8d6563">Stop Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>iMacrosControl<span id="LST72236F82_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST72236F82_0?cpp=::|nu=.");</script>Play Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Plays the specified macro code or path.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="70f4a70b-7236-3439-3ee4-75d5cd107a12.htm">iMacros.Component</a><br />
    <strong>Assembly:</strong>
   iMacros.Component (in iMacros.Component.dll) Version: 12.5.503.8802<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0ECCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','cs','1','3');return false;">C#</a></div><div id="ID0ECCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','vb','2','3');return false;">VB</a></div><div id="ID0ECCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','cpp','3','3');return false;">C++</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0ECCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0ECCA');return false;" title="Copy">Copy</a></div></div><div id="ID0ECCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">int</span> <span class="identifier">Play</span>(
	<span class="identifier">string</span> <span class="parameter">macroCodeOrPath</span>
)</pre></div><div id="ID0ECCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">Play</span> ( 
	<span class="parameter">macroCodeOrPath</span> <span class="keyword">As</span> <span class="identifier">String</span>
) <span class="keyword">As</span> <span class="identifier">Integer</span></pre></div><div id="ID0ECCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="identifier">int</span> <span class="identifier">Play</span>(
	<span class="identifier">String</span>^ <span class="parameter">macroCodeOrPath</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0ECCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">macroCodeOrPath</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST72236F82_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST72236F82_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />The macro code (starting with the keyword <span class="code">"CODE:"</span>) or a full path 
            to a file containing the macro.
            If <a href="http://msdn2.microsoft.com/en-us/library/t070a83t" target="_blank">IsPathRooted(String)</a> returns false, iMacros will look for the file in the iMacros macros folder.
            The iMacros directories location can be set in the <span class="code">HKEY_CURRENT_USER\Software\Ipswitch\iMacros</span> registry key.
            See the iMacros reference for the detailed values.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">Int32</a><br />An <span class="keyword">int</span> error code. A -99 return value means that the player is busy, either playing or paused.</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID2RBSection" class="collapsibleSection">The caller should check this instance's current <a href="fdde9410-0c16-4b08-73fe-00d37e4cffe5.htm">PlayerMode</a> before calling this method. In case the
            player is not in Idle mode, <span class="selflink">Play(String)</span> returns -99.</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Examples</span></div><div id="ID3RBSection" class="collapsibleSection">
            The example below assumes a Form with a <a href="http://msdn2.microsoft.com/en-us/library/kbxtbzd1" target="_blank">Panel</a> where to add the iMacros control
            and a play <a href="http://msdn2.microsoft.com/en-us/library/031c58k4" target="_blank">Button</a> with a click event
            <div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAACBA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAACBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAACBA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">using</span> System;
<span class="highlight-keyword">using</span> System.Windows.Forms;
<span class="highlight-keyword">using</span> iMacros.Component;

<span class="highlight-keyword">public</span> <span class="highlight-keyword">partial</span> <span class="highlight-keyword">class</span> MainForm : Form
{
    <span class="highlight-keyword">private</span> iMacrosControl iim;

    <span class="highlight-keyword">public</span> MainForm()
    {
        InitializeComponent();
        iim = iMacrosControl.Create(<span class="highlight-literal">"xxxx"</span>) <span class="highlight-comment">// Use here the license key for iMacros.Component</span>
        iim.Dock = DockStyle.Fill;
        browserPane.Controls.Add(iim);
    }
    <span class="highlight-keyword">private</span> <span class="highlight-keyword">void</span> play_Click(<span class="highlight-keyword">object</span> sender, EventArgs e)
    {
        <span class="highlight-keyword">if</span> (iim == <span class="highlight-keyword">null</span>) 
            <span class="highlight-keyword">return</span>;

        <span class="highlight-comment">// Take care that the player is in idle mode before starting to play a macro</span>
        <span class="highlight-keyword">if</span> (iim.PlayerMode != PlaybackModes.Idle) 
            <span class="highlight-keyword">return</span>;        

        <span class="highlight-keyword">string</span> macro = <span class="highlight-literal">"CODE:URL GOTO=http://www.imacros.net/ \nTAG POS=3 TYPE=A ATTR=CLASS:toplink"</span>;
        <span class="highlight-keyword">int</span> res = iim.Play(macro);

        <span class="highlight-keyword">if</span> (res == <span class="highlight-number">-99</span>) <span class="highlight-comment">// res == -99 means that the player was in playing mode when Play was called. </span>
            MessageBox.Show(<span class="highlight-literal">"Player is still playing"</span>);

        MessageBox.Show(String.Format(<span class="highlight-literal">"Play result is {0}"</span>, iim.ErrorText);
    }
}</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAACBA");</script></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID4RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="529dd334-de25-1561-961f-e1d3d9a778cd.htm">iMacrosControl Class</a></div><div class="seeAlsoStyle"><a href="70f4a70b-7236-3439-3ee4-75d5cd107a12.htm">iMacros.Component Namespace</a></div><div class="seeAlsoStyle"><a href="f4d106b6-b2e6-9d08-e181-4ec3bf8d6563.htm">iMacrosControl<span id="LST72236F82_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST72236F82_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Stop<span id="LST72236F82_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST72236F82_3?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a></div><div class="seeAlsoStyle"><a href="c19502b3-6d15-61f7-74f5-ed68de9ad37d.htm">iMacrosControl<span id="LST72236F82_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST72236F82_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>PauseOrContinue<span id="LST72236F82_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST72236F82_5?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="http://imacros.net" target="_blank">Copyright (C) 2018 Ipswitch, Inc</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:iMacrosSupport%40ipswitch.com?Subject=iMacros Component">iMacros support</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> </div></body></html>